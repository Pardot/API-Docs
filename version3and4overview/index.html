<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Official documentation for the Pardot API">
        
        <link rel="canonical" href="http://developer.pardot.com/version3and4overview/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Overview (v3/v4) - Pardot API Documentation</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/prettify-1.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            // Current page data
            var mkdocs_page_name = "Overview (v3/v4)";
            var mkdocs_page_input_path = "version3and4overview.md";
            var mkdocs_page_url = "/version3and4overview/";
        </script>
        

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">Pardot API Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">API <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li class=" ">
                                <a href="..">
                                    
                                    Official Pardot API Documentation
                                    
                                </a>
                            </li>
                        
                            <li class="active ">
                                <a href="./">
                                    
                                    Overview (v3/v4)
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/authentication/">
                                    
                                    Authentication
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/object-field-references/">
                                    
                                    Object Field References (v3/v4)
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/">
                                    
                                    Transitioning to Version 4
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/release-notes/">
                                    
                                    Release Notes
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/error-codes-messages/">
                                    
                                    Error Codes & Messages
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/bulk-data-pull/">
                                    
                                    Bulk Data Pull
                                    
                                </a>
                            </li>
                        
                        </ul>
                    </li>
                
            
            
            
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Version 3 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/accounts/">
                                    
                                    Accounts
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/campaigns/">
                                    
                                    Campaigns
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/custom-fields/">
                                    
                                    Custom Fields
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/custom-redirects/">
                                    
                                    Custom Redirects
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/dynamic-content/">
                                    
                                    Dynamic Content
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/emails/">
                                    
                                    Email
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/batch-email-clicks/">
                                    
                                    Email Clicks
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/email-templates/">
                                    
                                    Email Templates
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/forms/">
                                    
                                    Forms
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/lifecycle-histories/">
                                    
                                    Lifecycle Histories
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/lifecycle-stages/">
                                    
                                    Lifecycle Stages
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/lists/">
                                    
                                    Lists
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/list-memberships/">
                                    
                                    List Memberships
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/opportunities/">
                                    
                                    Opportunities
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/prospects/">
                                    
                                    Prospects
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/prospect-accounts/">
                                    
                                    Prospect Accounts
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/tags/">
                                    
                                    Tags
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/tag-objects/">
                                    
                                    TagObjects
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/users/">
                                    
                                    Users
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/visitors/">
                                    
                                    Visitors
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/visitor-activities/">
                                    
                                    Visitor Activities
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/visits/">
                                    
                                    Visits
                                    
                                </a>
                            </li>
                        
                            <li class=" separator-above">
                                <a href="../kb/api-version-3/import/">
                                    
                                    Import API (for Prospects)
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-3/export/">
                                    
                                    Export API
                                    
                                </a>
                            </li>
                        
                        </ul>
                    </li>
                
            
            
            
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Version 4 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/accounts/">
                                    
                                    Accounts
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/campaigns/">
                                    
                                    Campaigns
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/custom-fields/">
                                    
                                    Custom Fields
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/custom-redirects/">
                                    
                                    Custom Redirects
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/dynamic-content/">
                                    
                                    Dynamic Content
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/emails/">
                                    
                                    Email
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/batch-email-clicks/">
                                    
                                    Email Clicks
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/email-templates/">
                                    
                                    Email Templates
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/forms/">
                                    
                                    Forms
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/lifecycle-histories/">
                                    
                                    Lifecycle Histories
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/lifecycle-stages/">
                                    
                                    Lifecycle Stages
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/lists/">
                                    
                                    Lists
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/list-memberships/">
                                    
                                    List Memberships
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/opportunities/">
                                    
                                    Opportunities
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/prospects/">
                                    
                                    Prospects
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/prospect-accounts/">
                                    
                                    Prospect Accounts
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/tags/">
                                    
                                    Tags
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/tag-objects/">
                                    
                                    TagObjects
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/users/">
                                    
                                    Users
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/visitors/">
                                    
                                    Visitors
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/visitor-activities/">
                                    
                                    Visitor Activities
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/visits/">
                                    
                                    Visits
                                    
                                </a>
                            </li>
                        
                            <li class=" separator-above">
                                <a href="../kb/api-version-4/import/">
                                    
                                    Import API (for Prospects)
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-4/export/">
                                    
                                    Export API
                                    
                                </a>
                            </li>
                        
                        </ul>
                    </li>
                
            
            
            
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Version 5 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li class=" ">
                                <a href="../kb/api-version-5/version5overview/">
                                    
                                    Overview
                                    
                                </a>
                            </li>
                        
                            <li class=" separator-above">
                                <a href="../kb/api-version-5/campaign/">
                                    
                                    Campaigns
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-5/custom-redirect/">
                                    
                                    Custom Redirects
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-5/file/">
                                    
                                    Files
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-5/folder/">
                                    
                                    Folders
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-5/form/">
                                    
                                    Forms
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-5/layout-template/">
                                    
                                    Layout Templates
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-5/prospect-account/">
                                    
                                    Prospect Accounts
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-5/tracker-domain/">
                                    
                                    Tracker Domains
                                    
                                </a>
                            </li>
                        
                            <li class=" ">
                                <a href="../kb/api-version-5/user/">
                                    
                                    Users
                                    
                                </a>
                            </li>
                        
                        </ul>
                    </li>
                
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li>
                    <a href="#mkdocs_search_modal" data-toggle="modal"><i class="fa fa-search"></i> Search</a>
                </li>
                
                
                <li>
                    <a rel="next" href="..">
                    <i class="fa fa-arrow-left"></i>
                    
                    Official Pardot API Documentation
                    
                    </a>
                </li>
                
                
                <li>
                    <a rel="prev" href="../kb/authentication/">
                    
                    Authentication
                    
                    <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#version-3-and-4-overview">Version 3 and 4 Overview</a></li>
            <li><a href="#using-the-api">Using the API</a></li>
            <li><a href="#request-format">Request Format</a></li>
            <li><a href="#sample-get-request">Sample GET Request</a></li>
            <li><a href="#sample-post-request">Sample POST Request</a></li>
            <li><a href="#changing-the-api-response-format">Changing the API Response Format</a></li>
            <li><a href="#sample-code">Sample Code</a></li>
    </ul>
</div></div>
            <div class="col-md-9 main-content" role="main">
                
                    <h1 id="version-3-and-4-overview">Version 3 and 4 Overview</h1>
<h2 id="using-the-api">Using the API</h2>
<p>The Pardot API lets your application access current data within Pardot. Through the API, you can perform several common operations on Pardot objects including the following:</p>
<ul>
<li><code>create</code> -- Creates a new object with the specified parameters.</li>
<li><code>read</code> -- Retrieves information about the specified object.</li>
<li><code>query</code> -- Retrieves objects that match specified criteria.</li>
<li><code>update</code> -- Updates elements of an existing object.</li>
<li><code>upsert</code> -- Updates elements of an existing object if it exists.  If the object does not exist, one is created using the supplied parameters.</li>
</ul>
<p>Developers must authenticate using a Salesforce OAuth endpoint or the Pardot API login endpoint before issuing Pardot API requests. Refer to the <a href="/kb/authentication">Authentication</a> section for details about this procedure.</p>
<p>Keep in mind a few considerations when you perform requests. For <code>update</code> requests, only the fields specified in the request are updated. All others are left unchanged. If a required field is cleared during an <code>update</code>, the request is declined.</p>
<h2 id="request-format">Request Format</h2>
<p>All requests to the API:</p>
<ul>
<li>Must use either HTTP <code>GET</code> or <code>POST</code></li>
<li>Must pass access token or user key and api key in an HTTP <code>Authorization</code> header.</li>
<li>Must pass Pardot Business Unit ID in an HTTP <code>Pardot-Business-Unit-Id</code> header if using an access token (obtained using Salesforce OAuth) to authenticate.</li>
<li>Must use the correct URL for your Pardot environment. See <a href="/#test-and-production-environments">Test and Production Environments</a>.</li>
</ul>
<h2 id="sample-get-request">Sample GET Request</h2>
<p>These examples use a production environment, so the domain is <code>pi.demo.pardot.com</code>. If you are using
a test environment, your domain is <code>pi.demo.pardot.com</code>. See <a href="/#test-and-production-environments">Test and Production Environments</a>.</p>
<h4 id="with-user-key-and-api-key-obtained-through-pardot-api-login-endpoint">With User Key and API Key (obtained through Pardot API login endpoint)</h4>
<pre><code>GET https://pi.pardot.com/api/&lt;object&gt;/version/3/do/&lt;op&gt;/&lt;id_field&gt;/&lt;id&gt;?&lt;params&gt; HTTP/1.1
Authorization: Pardot api_key=&lt;your_api_key&gt;, user_key=&lt;your_user_key&gt;
</code></pre>
<h4 id="with-salesforce-oauth-access-token-obtained-through-salesforce-oauth-endpoint">With Salesforce OAuth Access Token (obtained through Salesforce OAuth endpoint)</h4>
<pre><code>GET https://pi.pardot.com/api/&lt;object&gt;/version/3/do/&lt;op&gt;/&lt;id_field&gt;/&lt;id&gt;?&lt;params&gt; HTTP/1.1
Authorization: Bearer &lt;access_token&gt;
Pardot-Business-Unit-Id: &lt;pardot_business_unit_id&gt;
</code></pre>
<h2 id="sample-post-request">Sample POST Request</h2>
<h4 id="with-user-key-and-api-key">With User Key and API Key</h4>
<pre><code>POST https://pi.pardot.com/api/&lt;object&gt;/version/3/do/&lt;op&gt;/&lt;id_field&gt;/&lt;id&gt; HTTP/1.1
Authorization: Pardot api_key=&lt;your_api_key&gt;, user_key=&lt;your_user_key&gt;

&lt;params&gt;
</code></pre>
<h5 id="request-parameters">Request Parameters</h5>
<table>
<thead>
<tr>
<th><strong>Parameter</strong></th>
<th><strong>Required</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>object</code></td>
<td>X</td>
<td>The object type to be returned by the API request</td>
</tr>
<tr>
<td><code>op</code></td>
<td>X</td>
<td>The operation to be performed on the specified object type</td>
</tr>
<tr>
<td><code>id_field</code></td>
<td>X</td>
<td>The field to be used as the identifier for the specified object</td>
</tr>
<tr>
<td><code>id</code></td>
<td>X</td>
<td>The identifier for the specified object(s)</td>
</tr>
<tr>
<td><code>your_api_key</code></td>
<td>X</td>
<td>The API key obtained during <a href="/kb/authentication">Authentication</a></td>
</tr>
<tr>
<td><code>your_user_key</code></td>
<td>X</td>
<td>The user key used during <a href="/kb/authentication">Authentication</a></td>
</tr>
<tr>
<td><code>format</code></td>
<td></td>
<td>The API data format: either xml (default) or json</td>
</tr>
<tr>
<td><code>params</code></td>
<td></td>
<td>Parameters specific to your request; See individual methods for details</td>
</tr>
</tbody>
</table>
<h4 id="with-salesforce-oauth">With Salesforce OAuth</h4>
<pre><code>POST https://pi.pardot.com/api/&lt;object&gt;/version/3/do/&lt;op&gt;/&lt;id_field&gt;/&lt;id&gt; HTTP/1.1
Authorization: Bearer &lt;access_token&gt;
Pardot-Business-Unit-Id: &lt;pardot_business_unit_id&gt;

&lt;params&gt;
</code></pre>
<h5 id="request-parameters_1">Request Parameters</h5>
<table>
<thead>
<tr>
<th><strong>Parameter</strong></th>
<th><strong>Required</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>object</code></td>
<td>X</td>
<td>The object type to be returned by the API request</td>
</tr>
<tr>
<td><code>op</code></td>
<td>X</td>
<td>The operation to be performed on the specified object type</td>
</tr>
<tr>
<td><code>id_field</code></td>
<td>X</td>
<td>The field to be used as the identifier for the specified object</td>
</tr>
<tr>
<td><code>id</code></td>
<td>X</td>
<td>The identifier for the specified object(s)</td>
</tr>
<tr>
<td><code>access_token</code></td>
<td>X</td>
<td>The access token obtained during <a href="/kb/authentication">Authentication</a></td>
</tr>
<tr>
<td><code>pardot_business_unit_id</code></td>
<td>X</td>
<td>The pardot business unit. For details see <a href="/kb/authentication">Authentication</a></td>
</tr>
<tr>
<td><code>format</code></td>
<td></td>
<td>The API data format: either xml (default) or json</td>
</tr>
<tr>
<td><code>params</code></td>
<td></td>
<td>Parameters specific to your request; See individual methods for details</td>
</tr>
</tbody>
</table>
<p>The ordering of parameters is arbitrary. Parameters are passed using conventional HTML parameter syntax, with <code>'?'</code> indicating the start of the parameter string (for GET requests only) and <code>'&amp;'</code> as the separator between parameters. With the exception of <code>&lt;format&gt;</code> and <code>&lt;params&gt;</code>, all components are required. Data returned from the API is formatted using JSON or XML 1.0 with UTF-8 character encoding. Keep in mind that some characters in the response may be encoded as HTML entities, requiring client-side decoding. Also, keep in mind that all parameters specified in an API request MUST be URL-encoded before they are submitted.</p>
<p>In general, the API returns XML or JSON containing a current version of the target object's data. But unsuccessful requests return a short response containing an error code and message. See Error Codes &amp; Messages for error descriptions and suggested remedies: <a href="/kb/error-codes-messages">kb/error-codes-messages</a></p>
<p><a name="14767-changing-xml-response-format" id="changing-xml-response-format"></a></p>
<h2 id="changing-the-api-response-format">Changing the API Response Format</h2>
<p>The Pardot API supports several output formats, and each returns different levels of detail in the XML or JSON response. Output formats are defined by specifying the <code>output</code> request parameter. Supported output formats include:</p>
<ul>
<li><code>full</code> -- Returns all supported data for the Pardot object and all objects associated with it.</li>
<li><code>simple</code> -- Returns all supported data for the data for the Pardot object.</li>
<li><code>mobile</code> -- Returns an abbreviated version of the object data. This output format is ideal for mobile applications.</li>
<li><code>bulk</code> -- Returns basic data for an object (does not provide total object count). Used for querying <a href="/kb/bulk-data-pull/">large amounts of data</a>.</li>
</ul>
<p>If the output request parameter is not defined, the output format defaults to <code>full</code>. See the XML Response Format sections for each object for details about the formats.</p>
<h2 id="sample-code">Sample Code</h2>
<p>Here's an example of calling the Pardot API using a simple PHP client using the cURL library.</p>
<p>Note: We strongly recommend <strong>against</strong> using PHP's <code>file_get_contents</code> function to call the Pardot API because
it makes error handling extremely cumbersome.</p>
<pre><code>&lt;?php

/**
 * Class SamplePardotApiClient
 *
 * Example PHP client to call the Pardot API
 */
class SamplePardotApiClient
{
    const BASE_URL = &quot;https://pi.pardot.com/api/&quot;;
    const SALESFORCE_OAUTH_TOKEN_URL = &quot;https://login.salesforce.com/services/oauth2/token&quot;;

    /** @var int $apiVersion */
    private $apiVersion;

    /** @var string $format  */
    private $format;

    public function __construct($apiVersion, $format = 'xml')
    {
        $this-&gt;apiVersion = $apiVersion;
        $this-&gt;format = $format;
    }

    /**
     * @param string $endpoint
     * @param string $operation
     * @param array $data
     * @param array $headers
     * @param array $queryParams
     * @param bool $useSalesforceOAuth
     * @return array
     * @throws Exception
     */
    public function post($endpoint, $operation, $data = [], $headers = [], $queryParams = [], $useSalesforceOAuth = true)
    {
        $curl_handle = $this-&gt;initRequest($endpoint, $operation, $headers, $queryParams, $useSalesforceOAuth);
        curl_setopt($curl_handle, CURLOPT_POST, true);
        // Add POST data if given
        if (!empty($data)) {
            curl_setopt($curl_handle, CURLOPT_POSTFIELDS, $data);
        }

        return $this-&gt;executeCall($curl_handle);
    }

    /**
     * @param string $endpoint
     * @param string $operation
     * @param array $headers
     * @param array $queryParams
     * @param bool $useSalesforceOAuth
     * @return array
     * @throws Exception
     */
    public function get($endpoint, $operation, $headers = [], $queryParams = [], $useSalesforceOAuth = true)
    {
        $curl_handle = $this-&gt;initRequest($endpoint, $operation, $headers, $queryParams, $useSalesforceOAuth);

        return $this-&gt;executeCall($curl_handle);
    }

    /**
     * @param string $endpoint
     * @param string $operation
     * @param array $headers
     * @param array $queryParams
     * @param bool $useSalesforceOAuth
     * @return false|resource
     */
    private function initRequest($endpoint, $operation, $headers = [], $queryParams = [], $useSalesforceOAuth = true)
    {
        // Construct our full URL to the Pardot API
        $url = $this-&gt;buildUrl($endpoint, $operation, $useSalesforceOAuth);
        // Add desired format to any query string params provided
        $queryParams['format'] = $this-&gt;format;
        // Build query string params into an encoded string
        $queryString = http_build_query($queryParams, null, '&amp;');
        // Append query string params to URL
        $url .= &quot;?{$queryString}&quot;;

        // Init curl handle and set standard curl options: timeouts / require SSL / verify SSL
        $curl_handle = curl_init($url);
        curl_setopt($curl_handle, CURLOPT_CONNECTTIMEOUT, 5);
        curl_setopt($curl_handle, CURLOPT_TIMEOUT, 30);
        curl_setopt($curl_handle, CURLOPT_PROTOCOLS, CURLPROTO_HTTPS);
        curl_setopt($curl_handle, CURLOPT_SSL_VERIFYHOST, 2);
        curl_setopt($curl_handle, CURLOPT_RETURNTRANSFER, 1);

        // Add any headers passed in such as Authorization header
        if (!empty($headers)) {
            curl_setopt($curl_handle, CURLOPT_HTTPHEADER, $headers);
        }

        return $curl_handle;
    }

    /**
     * @param string $endpoint
     * @param string $operation
     * @param bool $useSalesforceOAuth
     * @return string
     */
    private function buildUrl($endpoint, $operation = &quot;&quot;, $useSalesforceOAuth = true)
    {
        if ($endpoint === 'login') {
            if ($useSalesforceOAuth) {
                return self::SALESFORCE_OAUTH_TOKEN_URL;
            } else {
                return self::BASE_URL . &quot;login&quot;;
            }
        }

        return self::BASE_URL . &quot;{$endpoint}/version/{$this-&gt;apiVersion}/do/{$operation}&quot;;
    }

    /**
     * @param $curl_handle
     * @return array
     * @throws Exception
     */
    private function executeCall($curl_handle)
    {
        // Execute our call to the Pardot API
        $rsp = curl_exec($curl_handle);
        // Gather the HTTP response code and last effective URL called
        $httpCode = curl_getinfo($curl_handle, CURLINFO_HTTP_CODE);
        $url = curl_getinfo($curl_handle, CURLINFO_EFFECTIVE_URL);

        // Handle errors in calls, this could be a log or an exception thrown as written here
        if (!$rsp) {
            $errorMessage = curl_error($curl_handle);
            curl_close($curl_handle);
            throw new Exception(&quot;Error calling API. HTTP Code: {$httpCode}. Message: {$errorMessage}&quot;);
        }
        curl_close($curl_handle);

        // Output call response for informational purposes
        echo(&quot;URL: {$url}&quot; . PHP_EOL);
        echo(&quot;HTTP Response Code: {$httpCode}&quot; . PHP_EOL);
        echo(&quot;Response: {$rsp}&quot; . PHP_EOL . PHP_EOL);

        return [$httpCode, $rsp];
    }

    /**
     * Use Pardot API using Api Key and User Key.
     */
    public function executeRequestsWithApiKeys()
    {
        // Setup user credentials
        $credentials = [
            'user_key' =&gt; '&lt;your_user_key&gt;',
            'email' =&gt; '&lt;your_pardot_user_email&gt;',
            'password' =&gt; '&lt;your_password&gt;'
        ];

        // Authenticate to Pardot - Must be a POST with credentials in the message body
        list($httpCode, $rsp) = $this-&gt;post('login', '', $credentials, null, [], false);
        // Capture the api_key from a successful login response
        // api_key is good for 1 hour and can be reused on subsequent calls
        $apiKey = json_decode($rsp, true)['api_key'];

        // Create Authorization Header from api_key
        $authHeader = [&quot;Authorization: Pardot user_key={$credentials['user_key']},api_key={$apiKey}&quot;];

        // Call Prospect Query
        list($httpCode, $rsp) = $this-&gt;get('prospect', 'query', $authHeader, ['limit' =&gt; 1]);
        // Call VisitorActivity Query
        list($httpCode, $rsp) = $this-&gt;get('visitorActivity', 'query', $authHeader, ['limit' =&gt; 1]);
        // Create a Campaign
        list($httpCode, $rsp) = $this-&gt;post(
            'campaign',
            'create',
            ['name' =&gt; 'A Campaign', 'cost' =&gt; 100],
            $authHeader
        );
    }

    /**
     * Use Pardot API with a SSO user.
     * Getting the access token and using that to use the Pardot API.
     */
    public function executeRequestsWithSalesforceOAuth()
    {
        // Setup user credentials
        $credentials = [
            &quot;grant_type&quot; =&gt; &quot;password&quot;,
            &quot;client_id&quot; =&gt; &quot;&lt;your_client_id&gt;&quot;,
            &quot;client_secret&quot; =&gt; &quot;&lt;your_client_secert&gt;&quot;,
            &quot;username&quot; =&gt; &quot;&lt;your_salesforce_email&gt;&quot;,
            &quot;password&quot; =&gt; &quot;&lt;your_password&gt;&quot;
        ];

        $pardot_business_unit_id = &quot;&lt;Pardot_business_unit_id&gt;&quot;;

        // Authenticate to Salesforce - Must be a POST with credentials in the message body
        list($httpCode, $rsp) = $this-&gt;post('login', '', $credentials, null, [], true);
        // Capture the access_token from a successful login response
        $access_token = json_decode($rsp, true)['access_token'];

        // Create Authorization Header from access_token and business unit
        $authHeader = [&quot;Authorization: Bearer {$access_token}&quot;, &quot;Pardot-Business-Unit-Id: {$pardot_business_unit_id}&quot;];

        // Call Prospect Query
        list($httpCode, $rsp) = $this-&gt;get('prospect', 'query', $authHeader, ['limit' =&gt; 1]);
        // Call VisitorActivity Query
        list($httpCode, $rsp) = $this-&gt;get('visitorActivity', 'query', $authHeader, ['limit' =&gt; 1]);
        // Create a Campaign
        list($httpCode, $rsp) = $this-&gt;post(
            'campaign',
            'create',
            ['name' =&gt; 'A Campaign', 'cost' =&gt; 100],
            $authHeader
        );
    }
}

// Prepare to call version 3 or 4 of the API with JSON or XML responses
$client = new SamplePardotApiClient(4, 'json');

// Authenticate to Pardot - Using API Keys
$client-&gt;executeRequestsWithApiKeys();

// Authenticate to Pardot - Using Salesforce OAuth
$client-&gt;executeRequestsWithSalesforceOAuth();
</code></pre>
                
            </div>
        </div>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form id="content_search">
                    <span role="status" aria-live="polite" class="ui-helper-hidden-accessible"></span>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" name="q" autocomplete="off" autofocus>
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/prettify-1.0.min.js"></script>
        <script>var base_url = '..';</script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>
        <script src="../search/main.js" defer></script>
    </body>
</html>